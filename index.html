<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ä¸‹åˆèŒ¶é»é¤ç³»çµ±</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }
    input, button {
      margin: 5px 0;
      padding: 5px;
    }
    .summary {
      background: #f0f0f0;
      padding: 10px;
      margin-top: 20px;
    }
    ul {
      padding-left: 20px;
    }
  </style>
</head>
<body>



    <h2>ä¸‹åˆèŒ¶é»é¤ç³»çµ±</h2>
  <form id="orderForm">
    <label>å§“åï¼š<br><input type="text" id="name" name="name" required></label><br>
    <label>é£Ÿç‰©ï¼š<br><input type="text" id="food" name="food"></label><br>
    <label>é£²æ–™ï¼š<br><input type="text" id="drink" name="drink"></label><br>
    <button type="submit">é€å‡º</button>
  </form>



    <div class="summary">
    <h3>çµ±è¨ˆçµæœ</h3>
    <div id="summary"></div>
  </div>

  <div>
    <h3>æ‰€æœ‰é»é¤</h3>
    <ul id="orderList"></ul>
  </div>



  <script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbwuX32uSPHxcql7M9aUSGSAgIdpEG3zHn4nQNiPCYsIESsZcJUCi32M1w2ZDOa9_5C1/exec"; 
  const form = document.getElementById("orderForm");
  const summary = document.getElementById("summary");
  const orderList = document.getElementById("orderList");

  form.addEventListener("submit", e => {
    e.preventDefault();
    fetch(scriptURL, {
      method: 'POST',
      body: new FormData(form)
    }).then(() => {
      form.reset();
      loadOrders();
    });
  });

  function loadOrders() {
    fetch(scriptURL + "?action=get")
      .then(res => res.json())
      .then(data => {
        orderList.innerHTML = "";
        let foodCount = {}, drinkCount = {};
        data.forEach(row => {
          const [name, food, drink] = row;
          orderList.innerHTML += `<li>${name}ï¼šğŸ± ${food} ğŸ§‹ ${drink}</li>`;
          if (food) foodCount[food] = (foodCount[food] || 0) + 1;
          if (drink) drinkCount[drink] = (drinkCount[drink] || 0) + 1;
        });
        summary.innerHTML = `ğŸ± é£Ÿç‰©çµ±è¨ˆï¼š<br>` + Object.entries(foodCount).map(([k,v]) => `${k}: ${v}`).join("<br>") +
                            `<br><br>ğŸ§‹ é£²æ–™çµ±è¨ˆï¼š<br>` + Object.entries(drinkCount).map(([k,v]) => `${k}: ${v}`).join("<br>");
      });
  }

  loadOrders();
</script>
</body>
</html>
